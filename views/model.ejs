<%- include('header.ejs') %>
<script>
  function changeOption() {
    var selectBox = document.getElementById("specs-selector");
    var selectedValue = selectBox.options[selectBox.selectedIndex].value;
    var ramlTextArea = document.getElementById("ramlTextArea");
    var oasTextArea = document.getElementById("oasTextArea");
    var classifier = document.getElementById("classifier");
    if (classifier) {
        classifier.value = selectedValue;
    } 
    if (selectedValue === "raml") {
      ramlTextArea.style.display = "block";
      oasTextArea.style.display = "none";
    } else {
      oasTextArea.style.display = "block";
      ramlTextArea.style.display = "none";
    }
  }
</script>
<form form method="post" action="/apid">
  <label for="specs">Choose a spec:</label>
  <select id="specs-selector" onchange="changeOption()">
    <option id="raml-spec" value="raml">RAML</option>
    <option id="oas-spec" value="oas">OAS</option>
  </select>
  <br /><br />
  <h4>Api Spec preview</h4>
  <textarea
    id="ramlTextArea"
    name="ramlSpec"
    style="width: 100%; height: 400px; display: block"
  >
<%= amfModelRaml %></textarea
  >
  <textarea
    id="oasTextArea"
    name="oasSpec"
    style="width: 100%; height: 400px; display: none"
  >
<%= amfModelOas %></textarea
  >
  <input type="hidden" name="name" value="<%= proxy.apiName %>"/>
  <input type="hidden" name="description" value="<%= proxy.apiDescription %>" />
  <input type="hidden" name="groupId" value="<%= process.env.ORG_ID || 'test'%>" />
  <input type="hidden" name="assetId" value=<%= proxy.apiName.toLowerCase().replace(/\s+/g, '-') %> />
  <input type="hidden" name="version" value="1.0.0" />
  <input type="hidden" name="apiVersion" value="v1" />
  <input id="classifier" hidden type="text" name="classifier" />
  <button type="submit" style="margin-top: 20px" class="btn btn-primary">
    Upload to Design Center
  </button>
</form>
<%- include('footer.ejs') %>)
